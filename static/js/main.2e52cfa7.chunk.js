(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,r){e.exports=r(40)},28:function(e,t,r){},39:function(e,t,r){!function(e){"use strict";function r(){}function n(e,t,r,n,a,o,i,c,s,l){var u,d,p,h;for(d=0,h=a;h!==i;h+=o)for(p=c;p!==l;p+=s,d++)u=t[d],e[4*(p+n*h)+3]=255,e[4*(p+n*h)+2]=r[3*u+0],e[4*(p+n*h)+1]=r[3*u+1],e[4*(p+n*h)+0]=r[3*u+2];return e}function a(e,t,r,n,a,o,i,c,s,l){var u,d,p,h;for(d=0,h=a;h!==i;h+=o)for(p=c;p!==l;p+=s,d+=2)u=t[d+0]|t[d+1]<<8,e[4*(p+n*h)+0]=(31744&u)>>7,e[4*(p+n*h)+1]=(992&u)>>2,e[4*(p+n*h)+2]=(31&u)>>3,e[4*(p+n*h)+3]=32768&u?0:255;return e}function o(e,t,r,n,a,o,i,c,s,l){var u,d,p;for(u=0,p=a;p!==i;p+=o)for(d=c;d!==l;d+=s,u+=3)e[4*(d+n*p)+3]=255,e[4*(d+n*p)+2]=t[u+0],e[4*(d+n*p)+1]=t[u+1],e[4*(d+n*p)+0]=t[u+2];return e}function i(e,t,r,n,a,o,i,c,s,l){var u,d,p;for(u=0,p=a;p!==i;p+=o)for(d=c;d!==l;d+=s,u+=4)e[4*(d+n*p)+2]=t[u+0],e[4*(d+n*p)+1]=t[u+1],e[4*(d+n*p)+0]=t[u+2],e[4*(d+n*p)+3]=t[u+3];return e}function c(e,t,r,n,a,o,i,c,s,l){var u,d,p,h;for(d=0,h=a;h!==i;h+=o)for(p=c;p!==l;p+=s,d++)u=t[d],e[4*(p+n*h)+0]=u,e[4*(p+n*h)+1]=u,e[4*(p+n*h)+2]=u,e[4*(p+n*h)+3]=255;return e}function s(e,t,r,n,a,o,i,c,s,l){var u,d,p;for(u=0,p=a;p!==i;p+=o)for(d=c;d!==l;d+=s,u+=2)e[4*(d+n*p)+0]=t[u+0],e[4*(d+n*p)+1]=t[u+0],e[4*(d+n*p)+2]=t[u+0],e[4*(d+n*p)+3]=t[u+1];return e}r.Type={NO_DATA:0,INDEXED:1,RGB:2,GREY:3,RLE_INDEXED:9,RLE_RGB:10,RLE_GREY:11},r.Origin={BOTTOM_LEFT:0,BOTTOM_RIGHT:1,TOP_LEFT:2,TOP_RIGHT:3,SHIFT:4,MASK:48},r.prototype.open=function(e,t){var r,n=this;(r=new XMLHttpRequest).open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200===this.status&&(n.load(new Uint8Array(r.response)),t&&t.call(n))},r.send(null)},r.prototype.load=function(e){var t=0;if(e.length<18)throw new Error("Targa::load() - Not enough data to contain header");if(this.header={idLength:e[t++],colorMapType:e[t++],imageType:e[t++],colorMapIndex:e[t++]|e[t++]<<8,colorMapLength:e[t++]|e[t++]<<8,colorMapDepth:e[t++],offsetX:e[t++]|e[t++]<<8,offsetY:e[t++]|e[t++]<<8,width:e[t++]|e[t++]<<8,height:e[t++]|e[t++]<<8,pixelDepth:e[t++],flags:e[t++]},this.header.hasEncoding=this.header.imageType===r.Type.RLE_INDEXED||this.header.imageType===r.Type.RLE_RGB||this.header.imageType===r.Type.RLE_GREY,this.header.hasColorMap=this.header.imageType===r.Type.RLE_INDEXED||this.header.imageType===r.Type.INDEXED,this.header.isGreyColor=this.header.imageType===r.Type.RLE_GREY||this.header.imageType===r.Type.GREY,function(e){if(e.imageType===r.Type.NO_DATA)throw new Error("Targa::checkHeader() - No data");if(e.hasColorMap){if(e.colorMapLength>256||24!==e.colorMapDepth||1!==e.colorMapType)throw new Error("Targa::checkHeader() - Invalid colormap for indexed type")}else if(e.colorMapType)throw new Error("Targa::checkHeader() - Why does the image contain a palette ?");if(e.width<=0||e.height<=0)throw new Error("Targa::checkHeader() - Invalid image size");if(8!==e.pixelDepth&&16!==e.pixelDepth&&24!==e.pixelDepth&&32!==e.pixelDepth)throw new Error('Targa::checkHeader() - Invalid pixel size "'+e.pixelDepth+'"')}(this.header),(t+=this.header.idLength)>=e.length)throw new Error("Targa::load() - No data");if(this.header.hasColorMap){var n=this.header.colorMapLength*(this.header.colorMapDepth>>3);this.palette=e.subarray(t,t+n),t+=n}var a=this.header.pixelDepth>>3,o=this.header.width*this.header.height,i=o*a;this.header.hasEncoding?this.imageData=function(e,t,r,n){var a,o,i,c,s,l;for(l=new Uint8Array(n),s=new Uint8Array(r),a=0;a<n;)if(i=1+(127&(o=e[t++])),128&o){for(c=0;c<r;++c)s[c]=e[t++];for(c=0;c<i;++c)l.set(s,a),a+=r}else for(i*=r,c=0;c<i;++c)l[a++]=e[t++];return l}(e,t,a,i):this.imageData=e.subarray(t,t+(this.header.hasColorMap?o:i))},r.prototype.getImageData=function(e){var t,l,u,d,p,h,g,f=this.header.width,m=this.header.height,E=(this.header.flags&r.Origin.MASK)>>r.Origin.SHIFT;switch(e||(e=document?document.createElement("canvas").getContext("2d").createImageData(f,m):{width:f,height:m,data:new Uint8ClampedArray(f*m*4)}),E===r.Origin.TOP_LEFT||E===r.Origin.TOP_RIGHT?(d=0,p=1,h=m):(d=m-1,p=-1,h=-1),E===r.Origin.TOP_LEFT||E===r.Origin.BOTTOM_LEFT?(t=0,l=1,u=f):(t=f-1,l=-1,u=-1),this.header.pixelDepth){case 8:g=this.header.isGreyColor?c:n;break;case 16:g=this.header.isGreyColor?s:a;break;case 24:g=o;break;case 32:g=i}return g(e.data,this.imageData,this.palette,f,d,p,h,t,l,u),e},r.prototype.getCanvas=function(e){var t,r;return e||(e=document.createElement("canvas")),r=(t=e.getContext("2d")).createImageData(this.header.width,this.header.height),e.width=this.header.width,e.height=this.header.height,t.putImageData(this.getImageData(r),0,0),e},r.prototype.getDataURL=function(e){return this.getCanvas().toDataURL(e||"image/png")};var l={};l.exports=t,l.exports&&(l.exports.TGA=r)}()},40:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(12),o=(r(28),r(3)),i=r(43),c=r(9),s=r(7),l=r(10),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getClass=function(e){return"trait-icon trait-icon-"+(e?"active":"inactive")},t.render=function(){return s.b.add(l.a,l.c,l.b,l.d),n.createElement("tr",{onClick:function(){return t.props.onSelected(t.props.objectRecord)}},n.createElement("th",{scope:"row"},t.props.objectRecord.id),n.createElement("td",null,t.props.objectRecord.description),n.createElement("td",null,t.props.objectRecord.containable?String(t.props.objectRecord.containSize):"\u221e"),n.createElement("td",null,n.createElement(c.a,{icon:"apple-alt",title:"Edible",size:"2x",className:t.getClass(t.props.objectRecord.foodValue>0)}),n.createElement(c.a,{icon:"tshirt",title:"Equipable",size:"2x",className:t.getClass("n"!==t.props.objectRecord.clothing)}),n.createElement(c.a,{icon:"horse",title:"Rideable",size:"2x",className:t.getClass(t.props.objectRecord.rideable)}),n.createElement(c.a,{icon:"weight-hanging",title:"Permanent",size:"2x",className:t.getClass(t.props.objectRecord.permanent)})))},t}return o.c(t,e),t}(n.Component),d=r(41),p=r(42),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){return n.createElement(d.a,null,n.createElement(p.a,{striped:!0,dark:!0,hover:!0},n.createElement("thead",{className:"thead-dark"},n.createElement("tr",null,n.createElement("th",null,"#"),n.createElement("th",null,"Name"),n.createElement("th",null,"Size"),n.createElement("th",null,"Traits"))),n.createElement("tbody",null,Object.values(t.props.objectRecord).sort(function(e,t){return e.id-t.id}).map(function(e){return n.createElement(u,{key:e.id,onSelected:t.props.onObjectSelected,objectRecord:e})}))))},t}return o.c(t,e),t}(n.Component),g=r(44),f=r(49),m=r(45),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgColor=function(){return t.props.progress.percent<0?"danger":"info"},t.getProgress=function(){return 100*(t.props.progress.percent<0?1:t.props.progress.percent)},t.render=function(){return n.createElement(i.a,null,n.createElement(d.a,null,n.createElement(g.a,{className:"data-loading"},n.createElement(f.a,{color:t.bgColor()},n.createElement("p",null,t.props.progress.message),n.createElement(m.a,{value:t.getProgress(),color:t.bgColor(),striped:!0,animated:!0})))))},t}return o.c(t,e),t}(n.Component),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearchSubmit=function(e){e.preventDefault();var r=new FormData(e.target);t.props.onSearch(r.get("filter")),t.setState(function(e){return o.a({},e,{filter:r.get("filter")})})},t.render=function(){return n.createElement("nav",{className:"navbar navbar-dark bg-dark fixed-top"},n.createElement("div",{className:"container"},n.createElement("a",{className:"navbar-brand h1 text-light",href:"#"},"One life item browser"),n.createElement("form",{className:"form-inline d-none d-sm-block",onSubmit:t.onSearchSubmit},n.createElement("input",{className:"form-control mr-sm-2",type:"search",name:"filter",placeholder:"Search","aria-label":"Search"}),n.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"submit"},"Search"))))},t}return o.c(t,e),t}(n.Component),b=r(46),w=r(47),P=r(48),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFirstPage=function(){return 0===t.props.currentPage},t.isSecondPage=function(){return 1===t.props.currentPage},t.isLastPage=function(){return t.props.currentPage===t.props.pageCount-1},t.isSecondLastPage=function(){return t.props.currentPage===t.props.pageCount-2},t.getMiddleNumber=function(){return t.isFirstPage()||t.isSecondPage()?2:t.isLastPage()||t.isSecondLastPage()?t.props.pageCount-3:t.props.currentPage},t.renderPage=function(e){return e<t.props.pageCount?n.createElement(b.a,{active:e===t.props.currentPage},n.createElement(w.a,{onClick:function(){return t.props.changePage(e)}},e+1)):null},t.renderDots=function(){return n.createElement(b.a,{disabled:!0},n.createElement(w.a,null,"..."))},t.render=function(){return n.createElement(d.a,{className:"justify-content-center"},n.createElement(g.a,{xs:"auto"},n.createElement(P.a,{className:"page-control"},n.createElement(b.a,{disabled:t.isFirstPage()},n.createElement(w.a,{previous:!0,onClick:function(){return t.props.changePage(t.props.currentPage-1)}})),t.props.currentPage>2&&t.renderPage(0),t.props.currentPage>3&&t.renderPage(1),t.props.currentPage>3&&t.renderDots(),t.renderPage(t.getMiddleNumber()-2),t.renderPage(t.getMiddleNumber()-1),t.renderPage(t.getMiddleNumber()),t.renderPage(t.getMiddleNumber()+1),t.renderPage(t.getMiddleNumber()+2),t.props.currentPage<t.props.pageCount-4&&t.renderDots(),t.props.currentPage<t.props.pageCount-4&&t.renderPage(t.props.pageCount-2),t.props.currentPage<t.props.pageCount-3&&t.renderPage(t.props.pageCount-1),n.createElement(b.a,{disabled:t.isLastPage()},n.createElement(w.a,{next:!0,onClick:function(){return t.props.changePage(t.props.currentPage+1)}})))))},t}return o.c(t,e),t}(n.Component),C=r(8),T=function(){function e(){}return e.baseUrl="https://onelifeitembrowser.herokuapp.com/api/",e.getRecords=function(){return o.b(void 0,void 0,Promise,function(){return o.d(this,function(t){switch(t.label){case 0:return[4,C.get(e.baseUrl+"records")];case 1:return[2,t.sent()]}})})},e}(),R=function(){function e(){}return e.initialize=function(t,r){return o.b(void 0,void 0,Promise,function(){var n;return o.d(this,function(a){switch(a.label){case 0:t({percent:1,message:"Fetching records..."}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,T.getRecords()];case 2:switch((n=a.sent()).outdated){case!1:return t(void 0),[2,n.records];case!0:return t(n.progress),e.waitForUpdate(t,r),[2,{}]}return[3,4];case 3:return a.sent(),t({percent:-1,message:"Unexpected error occured. Please refresh the page."}),[2,{}];case 4:return[2,{}]}})})},e.sleep=function(e){return o.b(void 0,void 0,void 0,function(){return o.d(this,function(t){return[2,new Promise(function(t){return setTimeout(t,e)})]})})},e.waitForUpdate=function(t,r){return o.b(void 0,void 0,void 0,function(){var n;return o.d(this,function(a){switch(a.label){case 0:a.trys.push([0,6,,7]),a.label=1;case 1:return[4,e.sleep(3e3)];case 2:return a.sent(),[4,T.getRecords()];case 3:switch((n=a.sent()).outdated){case!1:return t(void 0),r(n.records),[2];case!0:t(n.progress)}a.label=4;case 4:return[3,1];case 5:return[3,7];case 6:return a.sent(),t({percent:-1,message:"Unexpected error occured. Please refresh the page."}),[3,7];case 7:return[2]}})})},e}(),S=r(50),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){return n.createElement("div",null,n.createElement("span",{className:"font-weight-bold key-str"},t.props.keyStr,":"),n.createElement("span",null,JSON.stringify(t.props.value)))},t}return o.c(t,e),t}(n.Component),D=r(39),O=function(){function e(){}return e.imgUrl="https://raw.githubusercontent.com/jasonrohrer/OneLifeData7/master/sprites/",e.render=function(t,r){return o.b(void 0,void 0,void 0,function(){var n,a,i,c,s,l;return o.d(this,function(o){switch(o.label){case 0:if(0===t.length)return[2];for((n=C(r).get()[0]).width=250,n.height=500,a=n.getContext("2d"),i=[],l=0;l<t.length;++l)i.push(e.getCanvas(t[l]));return[4,Promise.all(i)];case 1:for(c=o.sent(),s=c.map(function(e,r){return{sprite:t[r],canvas:e}}),l=0;l<t.length;++l)e.addSprite(l,s,a);return[2]}})})},e.getCanvas=function(t){return o.b(void 0,void 0,Promise,function(){return o.d(this,function(r){switch(r.label){case 0:return[4,new Promise(function(r,n){var a=new D.TGA;a.open(e.imgUrl+t.id+".tga",function(){r(a.getCanvas(C("#"+t.id).get()[0]))})}).catch(function(e){throw e})];case 1:return[2,r.sent()]}})})},e.addSprite=function(t,r,n){return o.b(void 0,void 0,void 0,function(){var a,i,c;return o.d(this,function(o){return a=e.getPosition(r[t]),i=a.x,c=a.y,n.drawImage(r[t].canvas,125+i,400-c),[2]})})},e.getPosition=function(e){return{x:e.sprite.position.x-e.canvas.width/2,y:e.sprite.position.y+e.canvas.height/2}},e}(),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainCanvasId=function(){return t.props.objectRecord.id.toString()},t.renderSpriteInfo=function(e){return n.createElement(g.a,{xs:"6",md:"4",lg:"3",className:"col-6 sprite-info"},n.createElement("div",{className:"sprite-info-preview"},n.createElement("canvas",{id:e.toString(),className:"sprite"})),n.createElement(j,{keyStr:"Id",value:e.id}),n.createElement(j,{keyStr:"Parent",value:e.parent}),n.createElement(j,{keyStr:"Pos",value:e.position}))},t.render=function(){return n.createElement(i.a,null,n.createElement(d.a,null,n.createElement(g.a,{md:"7",lg:"8"},n.createElement(d.a,null,n.createElement(S.a,{color:"link",onClick:t.props.close},"< Back to listing")),n.createElement(d.a,null,n.createElement(g.a,null,n.createElement("h2",null,t.props.objectRecord.description),n.createElement(j,{keyStr:"Id",value:t.props.objectRecord.id})))),n.createElement(g.a,{md:"5",lg:"4"},n.createElement("div",{className:"sprite-preview"},n.createElement("canvas",{id:t.mainCanvasId(),className:"sprite"})))),n.createElement(d.a,null,n.createElement(g.a,null,n.createElement("h3",null,"All sprites:"))),n.createElement(d.a,null,t.props.objectRecord.sprites.map(t.renderSpriteInfo)))},t}return o.c(t,e),t.prototype.componentDidMount=function(){O.render(this.props.objectRecord.sprites,"#"+this.mainCanvasId())},t}(n.Component),N=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={objectRecords:{},selectedRecord:void 0,filter:"",filteredCount:0,itemsPerPage:25,currentPage:0},r.componentDidMount=function(){return o.b(r,void 0,void 0,function(){var e;return o.d(this,function(t){switch(t.label){case 0:return[4,R.initialize(this.onLoadingProgress,this.onLoadingDone)];case 1:return e=t.sent(),this.setState(function(t){return o.a({},t,{objectRecords:e,filteredCount:Object.keys(e).length})}),[2]}})})},r.getFilteredObjects=function(){return Object.values(r.state.objectRecords).filter(function(e){return t.stringContains(e.description,r.state.filter)}).slice(r.state.currentPage*r.state.itemsPerPage,r.state.currentPage*r.state.itemsPerPage+r.state.itemsPerPage)},r.getPageControlProps=function(){return{currentPage:r.state.currentPage,pageCount:Math.ceil(r.state.filteredCount/r.state.itemsPerPage)-1,changePage:r.onChangePage}},r.showLoading=function(){return void 0!==r.state.progress},r.onSearchSubmit=function(e){r.setState(function(r){return o.a({},r,{filter:e,filteredCount:Object.values(r.objectRecords).filter(function(r){return t.stringContains(r.description,e)}).length})})},r.onChangePage=function(e){r.setState(function(t){return o.a({},t,{currentPage:e})})},r.onLoadingProgress=function(e){r.setState(function(t){return o.a({},t,{progress:e})})},r.onLoadingDone=function(e){r.setState(function(t){return o.a({},t,{objectRecords:e,filteredCount:Object.keys(e).length})})},r.onObjectSelected=function(e){r.setState(function(t){return o.a({},t,{selectedRecord:e.id})})},r.onObjectClosed=function(){r.setState(function(e){return o.a({},e,{selectedRecord:void 0})})},r.renderTabel=function(){return n.createElement(i.a,null,n.createElement(h,{objectRecord:r.getFilteredObjects(),onObjectSelected:r.onObjectSelected}),r.state.filteredCount>r.state.itemsPerPage&&n.createElement(y,o.a({},r.getPageControlProps())))},r.renderObjectRecord=function(){return n.createElement(k,{objectRecord:r.state.objectRecords[r.state.selectedRecord],close:r.onObjectClosed})},r.render=function(){return n.createElement("div",null,n.createElement(v,{onSearch:r.onSearchSubmit}),n.createElement("main",{role:"main"},r.showLoading()&&n.createElement(E,{progress:r.state.progress}),r.state.selectedRecord?r.renderObjectRecord():r.renderTabel()))},r}return o.c(t,e),t.stringContains=function(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0},t}(n.Component),L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.render(n.createElement(N,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/OneLifeItemBrowser",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="/OneLifeItemBrowser/service-worker.js";L?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):x(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):x(e)})}}()}},[[23,2,1]]]);
//# sourceMappingURL=main.2e52cfa7.chunk.js.map